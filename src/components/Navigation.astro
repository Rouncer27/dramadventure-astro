---
import { replaceUrls } from "../utils/replaceUrls";
import "../style/components/navigation.scss";

const response = await fetch(`${import.meta.env.WPGRAPHQL_URL}`, {
  method: "POST",
  headers: {
    "content-type": "application/json",
  },
  body: JSON.stringify({
    query: `
    query MainMenuQuery {
        mainMenu {
            mainMenu {
                menuItems {
                    menuItem {
                        label
                        destination {
                            ... on Page {
    
                                link
                            }
                        }
                    }
                }
            }
        }
    }
  `,
  }),
});

const { data } = await response.json();
const { menuItems } = data.mainMenu.mainMenu;
---

<nav class="main-navigation">
  <ul>
    {
      menuItems.map(({ menuItem }) => {
        const href = replaceUrls(menuItem.destination.link, Astro.url.origin);
        return (
          <li>
            <a class="p-two" href={href}>
              {menuItem.label}
            </a>
          </li>
        );
      })
    }
  </ul>
</nav>
